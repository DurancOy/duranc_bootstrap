#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -v -r -f duranc_plat_local_http.sh 
#endif

static  char data [] = 
#define      chk1_z	22
#define      chk1	((&data[0]))
	"\345\364\351\100\140\013\213\346\172\306\267\005\052\275\215\231"
	"\216\371\141\067\171\174\031"
#define      tst2_z	19
#define      tst2	((&data[24]))
	"\111\066\307\325\026\163\142\336\053\155\354\276\300\000\016\214"
	"\326\140\275\375\256"
#define      msg2_z	19
#define      msg2	((&data[44]))
	"\140\061\304\362\054\321\376\066\334\024\354\215\316\165\256\337"
	"\372\001\065\004"
#define      chk2_z	19
#define      chk2	((&data[64]))
	"\040\222\232\154\162\134\125\234\167\271\127\022\214\324\141\361"
	"\246\057\174\061"
#define      msg1_z	65
#define      msg1	((&data[88]))
	"\267\262\322\123\032\030\361\145\125\240\313\001\262\001\272\142"
	"\333\226\071\363\011\337\125\145\070\054\366\056\333\276\137\040"
	"\063\204\106\251\221\350\047\273\107\331\126\360\214\025\202\055"
	"\217\101\205\245\140\103\047\312\004\252\035\156\246\101\043\021"
	"\374\276\036\052\046\051\145"
#define      date_z	1
#define      date	((&data[155]))
	"\047"
#define      xecc_z	15
#define      xecc	((&data[156]))
	"\361\005\161\235\222\272\202\354\215\165\023\273\273\161\174"
#define      tst1_z	22
#define      tst1	((&data[173]))
	"\146\273\200\221\003\062\072\376\135\350\151\250\234\333\324\122"
	"\232\330\314\276\104\217\031\234"
#define      lsto_z	1
#define      lsto	((&data[195]))
	"\055"
#define      shll_z	10
#define      shll	((&data[198]))
	"\030\302\123\145\313\046\125\174\100\146\074\201\326\117"
#define      pswd_z	256
#define      pswd	((&data[272]))
	"\033\254\114\355\377\166\122\060\070\313\210\144\316\012\320\352"
	"\161\214\134\041\366\157\373\257\210\276\206\327\262\173\162\315"
	"\047\277\272\047\066\015\127\156\330\340\323\246\353\244\221\134"
	"\060\355\176\046\135\172\326\345\071\135\275\353\330\060\030\024"
	"\010\351\003\064\132\126\230\360\325\045\140\374\025\264\375\154"
	"\230\173\141\077\316\336\277\301\172\145\064\225\015\115\252\025"
	"\066\255\111\221\003\342\202\331\007\342\326\035\227\323\211\060"
	"\117\352\157\035\311\057\337\104\225\023\331\242\141\203\270\227"
	"\060\002\051\064\344\253\015\353\216\343\010\046\267\222\126\006"
	"\175\306\044\106\365\003\212\213\027\144\055\170\347\346\020\027"
	"\350\071\114\314\344\131\270\163\075\301\231\365\123\360\373\320"
	"\267\040\027\255\043\242\070\072\006\146\263\355\114\303\005\064"
	"\374\121\001\341\253\271\124\351\172\356\336\315\336\332\236\226"
	"\372\266\103\035\130\173\130\136\341\014\114\055\317\121\142\314"
	"\243\143\255\116\034\002\070\226\360\026\144\317\360\003\145\352"
	"\271\251\010\022\044\141\161\006\155\275\064\075\017\226\011\262"
	"\371\267\001\025\271\072\254\252\120\021\172\101\025\337\054\317"
	"\211\064\341\255\226\122\264\003\020\350\101\040\177\112\323\170"
	"\001\325\216\273\017\073\145\137\115\337\240\142\277\315\062\110"
	"\001\024\366\230\147\252\234\167\223\335\227\022\047\152\270\000"
	"\357\162\050\046\200\177\224\130\140\147\377\113\014\221\250\074"
	"\177\047\143\334\242\071\302\333\226\200\306\157\261\176\157\241"
	"\361\227\307\161\027"
#define      rlax_z	1
#define      rlax	((&data[567]))
	"\342"
#define      opts_z	1
#define      opts	((&data[568]))
	"\206"
#define      text_z	3858
#define      text	((&data[914]))
	"\014\332\224\157\267\066\251\172\021\100\373\327\257\254\126\037"
	"\115\107\267\025\270\317\161\203\107\065\115\013\006\251\170\022"
	"\204\014\202\073\102\054\266\123\155\262\053\034\136\201\074\254"
	"\310\364\302\201\304\063\005\013\151\122\027\157\373\217\202\177"
	"\234\005\273\336\061\162\062\236\044\136\273\203\337\370\057\250"
	"\354\361\052\260\045\057\274\216\202\324\376\176\144\200\376\000"
	"\205\271\337\267\054\021\125\120\157\021\323\117\011\003\370\366"
	"\364\042\247\032\122\143\250\324\070\247\122\234\047\121\235\254"
	"\012\174\143\067\215\271\207\375\312\132\114\324\135\105\312\122"
	"\147\161\154\272\325\025\216\015\274\341\252\344\062\107\221\075"
	"\303\364\164\120\256\374\116\171\126\233\115\264\340\027\007\110"
	"\210\164\002\135\212\221\153\107\163\025\053\245\134\274\343\037"
	"\261\130\160\137\124\276\330\253\132\045\140\072\075\147\203\305"
	"\334\205\043\146\027\216\255\212\244\331\060\000\225\024\040\106"
	"\154\220\246\301\117\177\154\252\244\314\345\342\064\150\250\021"
	"\356\313\170\005\132\045\220\376\376\300\376\224\325\036\332\101"
	"\257\201\002\377\000\157\251\245\074\216\207\160\367\057\202\345"
	"\372\372\352\124\040\173\123\036\073\121\263\021\160\216\122\040"
	"\017\125\040\017\304\311\264\000\130\073\161\120\153\363\065\146"
	"\355\040\272\015\233\016\054\327\137\340\350\320\156\073\360\175"
	"\220\020\215\125\332\101\126\063\175\310\203\350\273\271\116\251"
	"\331\011\267\165\027\344\114\167\304\044\005\236\244\142\125\266"
	"\275\176\333\106\362\107\265\256\316\045\020\011\130\236\263\050"
	"\077\100\147\374\310\021\224\014\141\000\364\251\302\177\355\373"
	"\066\155\070\356\357\172\074\343\067\055\235\221\266\267\166\134"
	"\166\246\157\154\321\304\052\356\235\137\333\267\375\127\025\221"
	"\243\243\364\226\250\143\254\346\040\160\175\152\015\324\047\073"
	"\160\134\065\100\157\200\204\371\333\031\063\164\076\116\244\213"
	"\266\110\321\212\074\226\332\136\341\071\111\305\207\102\237\007"
	"\331\047\004\303\264\110\016\206\076\033\060\364\244\113\040\045"
	"\024\176\125\274\137\007\276\114\153\031\011\310\054\230\070\131"
	"\200\201\214\043\123\134\367\126\367\276\144\023\115\077\375\132"
	"\132\246\153\063\012\342\157\067\070\240\073\203\017\016\244\317"
	"\223\141\021\254\112\373\156\304\265\026\330\217\150\134\063\330"
	"\252\044\036\170\073\336\005\134\041\140\152\354\153\304\303\235"
	"\273\300\106\107\226\315\275\245\310\026\011\327\243\246\204\065"
	"\100\362\017\152\054\333\141\165\155\100\127\354\225\114\303\074"
	"\174\224\023\236\157\221\032\112\074\166\142\132\010\320\137\214"
	"\131\062\110\053\301\104\351\314\320\036\016\225\047\147\012\234"
	"\013\144\374\315\261\360\372\272\251\073\277\262\013\053\150\206"
	"\240\215\111\111\353\360\034\106\367\256\360\227\312\322\214\022"
	"\043\355\341\154\124\311\347\040\121\025\146\205\023\047\325\246"
	"\257\117\232\230\057\223\012\115\255\150\355\027\145\260\077\341"
	"\073\201\164\075\223\106\055\230\361\332\113\354\301\256\212\075"
	"\030\203\077\153\105\261\070\121\162\172\340\346\204\057\364\024"
	"\340\075\300\201\256\201\363\206\200\067\076\267\331\263\265\121"
	"\251\107\121\271\020\062\312\175\206\251\212\337\077\050\371\052"
	"\367\337\374\042\334\073\175\047\171\174\224\264\213\226\036\335"
	"\014\050\163\032\245\357\225\265\102\113\341\311\156\303\352\035"
	"\070\344\144\277\307\147\130\272\217\223\327\027\165\244\006\152"
	"\162\252\322\377\152\320\257\131\012\076\347\347\327\023\310\115"
	"\062\175\145\223\163\115\101\107\302\350\150\004\035\224\201\001"
	"\000\167\107\253\130\123\064\332\144\041\134\320\242\056\023\043"
	"\037\142\310\201\350\002\040\314\212\141\221\155\176\230\032\325"
	"\022\317\305\251\231\365\235\350\264\270\067\111\364\303\074\014"
	"\372\250\071\207\364\116\210\335\257\042\231\144\222\057\046\104"
	"\130\210\217\070\155\153\324\057\177\316\110\127\246\360\162\357"
	"\353\005\260\255\062\113\367\327\172\376\001\264\250\147\252\150"
	"\347\155\125\041\000\024\206\302\076\360\357\010\344\052\031\247"
	"\322\251\023\067\200\374\340\276\240\264\123\363\075\226\376\032"
	"\267\067\200\123\121\047\301\225\237\134\057\035\226\142\212\057"
	"\352\075\017\113\152\223\351\323\047\363\240\332\006\362\057\202"
	"\324\146\342\311\334\136\203\215\111\352\052\116\164\121\000\106"
	"\007\125\165\126\246\140\034\232\104\234\031\030\376\012\332\075"
	"\342\147\135\333\330\335\374\055\312\071\370\174\114\026\221\147"
	"\232\030\251\120\321\147\102\347\352\131\073\300\250\333\342\147"
	"\264\367\016\132\350\325\374\254\030\071\343\215\372\033\016\005"
	"\205\372\105\204\301\255\027\264\041\327\071\024\103\224\223\232"
	"\277\156\372\235\024\103\257\140\160\347\341\067\211\022\210\347"
	"\032\250\330\126\252\205\244\275\301\331\357\065\353\311\256\205"
	"\275\251\270\337\261\137\122\261\346\250\127\112\045\101\112\031"
	"\100\367\263\142\223\336\343\167\263\320\022\201\105\203\074\065"
	"\134\152\132\132\275\041\024\154\105\110\035\110\055\355\361\030"
	"\043\360\037\067\100\374\154\366\107\011\300\070\321\046\126\220"
	"\201\045\314\054\014\045\132\357\047\307\036\131\027\311\275\130"
	"\367\372\274\370\261\374\360\161\034\250\043\331\043\173\262\245"
	"\321\216\152\366\371\063\341\307\335\111\003\035\234\375\335\072"
	"\050\136\045\024\241\154\212\252\252\342\041\170\102\364\076\037"
	"\047\213\336\177\057\333\205\306\371\354\044\020\141\257\043\023"
	"\042\106\047\004\076\103\234\241\356\053\230\320\073\064\110\276"
	"\245\153\052\332\162\354\254\055\354\367\067\037\152\123\144\054"
	"\326\301\257\057\123\323\113\241\070\015\122\025\376\160\343\107"
	"\071\000\040\273\112\116\006\054\314\222\173\020\314\332\040\113"
	"\324\126\127\044\276\135\333\207\102\220\252\272\350\241\041\003"
	"\072\325\033\067\140\225\227\060\026\263\146\265\244\211\314\342"
	"\073\027\250\313\050\063\353\207\231\073\062\057\072\120\171\177"
	"\316\140\374\234\030\146\072\240\224\224\311\365\156\125\251\042"
	"\022\025\241\310\164\260\200\063\103\211\057\172\265\301\356\373"
	"\111\210\122\133\270\167\276\105\046\312\077\036\263\203\311\345"
	"\337\326\147\230\162\233\056\277\246\306\322\232\240\265\356\065"
	"\277\066\116\273\105\055\122\054\206\132\360\357\376\117\365\263"
	"\174\332\347\042\233\312\127\363\177\266\305\262\357\341\051\053"
	"\157\144\201\055\035\024\255\334\212\121\326\345\163\243\251\162"
	"\057\170\311\347\251\147\046\264\231\304\316\301\127\075\371\063"
	"\060\214\213\341\017\237\342\054\072\242\335\142\137\046\021\255"
	"\321\130\232\313\233\332\045\001\245\332\204\062\276\355\061\011"
	"\164\225\045\364\217\347\167\212\107\236\146\157\137\041\362\362"
	"\173\342\222\230\064\156\251\306\117\235\060\056\021\124\242\052"
	"\177\171\073\043\043\252\111\354\367\221\242\156\027\205\071\073"
	"\036\014\036\077\316\150\225\210\270\147\134\361\351\266\272\055"
	"\050\267\261\067\257\070\233\223\122\162\162\123\016\123\354\225"
	"\330\267\270\150\146\070\023\334\024\076\256\305\353\202\325\211"
	"\100\072\310\070\112\163\341\003\243\366\230\060\252\122\217\234"
	"\322\370\102\141\221\330\243\206\152\303\076\351\367\160\142\313"
	"\364\002\374\213\055\253\241\303\376\123\131\030\363\117\145\150"
	"\343\335\343\261\223\213\253\023\332\340\050\367\370\253\267\010"
	"\065\342\114\046\222\237\333\151\224\332\123\207\236\037\342\357"
	"\045\161\015\261\121\156\263\272\305\326\020\336\102\376\341\301"
	"\226\163\332\257\160\217\000\222\345\352\036\145\064\210\157\035"
	"\343\212\012\317\121\065\330\372\027\022\261\116\016\100\005\066"
	"\355\042\266\312\141\162\025\352\227\265\146\061\102\074\070\312"
	"\212\254\312\320\377\224\153\143\113\166\137\121\050\205\052\100"
	"\332\372\113\213\351\170\027\247\220\172\261\073\217\376\104\145"
	"\370\366\140\377\344\350\024\103\176\241\337\241\345\256\226\334"
	"\001\255\057\260\030\272\044\136\111\362\132\056\005\255\002\126"
	"\153\356\231\200\350\163\007\364\052\112\371\065\351\222\322\060"
	"\126\027\242\220\342\302\252\340\022\366\234\161\173\041\056\155"
	"\356\136\275\115\047\114\171\366\100\352\136\064\036\056\200\121"
	"\314\230\006\251\026\232\111\024\355\315\053\141\127\254\233\225"
	"\040\153\035\336\102\067\211\124\321\204\320\221\006\352\077\232"
	"\240\070\112\361\361\157\357\247\211\011\003\343\316\170\106\100"
	"\206\256\027\012\341\066\112\040\210\252\134\353\101\142\200\321"
	"\014\042\136\155\144\364\304\001\276\002\174\326\250\270\132\376"
	"\223\273\276\106\177\037\103\123\270\240\306\235\115\026\352\077"
	"\110\214\027\006\346\046\350\214\010\247\364\262\376\313\071\045"
	"\167\115\316\074\244\366\052\224\252\110\247\052\330\270\232\305"
	"\002\214\126\244\003\211\354\262\123\314\301\165\157\102\375\377"
	"\173\354\230\220\235\115\070\341\076\367\131\355\160\214\236\131"
	"\201\333\166\134\132\034\102\234\011\376\007\236\350\025\122\122"
	"\047\042\243\303\351\025\232\127\326\234\261\275\272\232\104\357"
	"\136\020\233\156\214\135\301\333\246\115\317\037\003\325\217\063"
	"\350\124\247\102\037\257\111\153\111\237\044\135\272\042\234\350"
	"\027\031\222\310\241\121\366\053\023\152\304\226\266\331\071\000"
	"\337\257\025\234\172\314\016\207\233\145\222\246\224\205\136\073"
	"\177\126\004\152\074\103\125\310\374\307\071\154\125\154\130\041"
	"\347\353\015\202\325\341\334\360\147\147\374\124\217\216\123\327"
	"\156\337\246\201\021\354\316\275\350\106\352\361\275\377\263\055"
	"\155\305\036\125\372\277\052\361\313\356\000\146\267\136\044\205"
	"\236\254\342\117\167\256\153\001\105\027\214\335\354\172\030\254"
	"\267\065\136\266\120\327\177\054\003\055\277\171\205\204\014\232"
	"\246\237\025\044\151\265\004\012\040\312\351\203\204\314\357\176"
	"\241\001\150\041\142\211\237\134\133\361\063\300\157\221\065\127"
	"\205\065\122\361\225\165\074\161\232\062\236\121\054\355\206\315"
	"\353\272\307\300\303\275\324\372\317\037\206\272\162\013\014\025"
	"\100\141\355\152\261\343\055\250\241\172\267\220\033\060\326\074"
	"\041\025\127\060\324\116\074\157\147\250\265\032\174\303\276\352"
	"\303\100\205\335\056\027\127\320\333\111\055\176\265\374\214\362"
	"\075\045\231\210\042\253\053\075\360\253\313\116\307\123\235\102"
	"\015\357\141\026\007\036\247\374\173\050\232\244\341\014\045\115"
	"\327\276\022\150\207\263\324\003\005\156\227\130\330\355\106\234"
	"\101\005\135\305\170\243\264\300\101\235\073\034\115\037\221\131"
	"\341\147\322\004\150\101\311\245\216\046\362\224\112\277\005\277"
	"\026\036\363\312\114\020\037\250\002\315\274\064\213\027\060\356"
	"\021\023\077\175\004\337\055\340\272\254\065\056\144\302\131\127"
	"\057\144\077\373\204\054\032\314\153\215\355\311\031\153\126\056"
	"\360\232\155\345\220\310\346\107\041\316\103\163\003\371\340\233"
	"\324\230\300\322\100\313\304\277\311\036\242\155\014\021\265\350"
	"\146\265\202\367\117\103\202\047\254\255\201\302\051\362\204\140"
	"\007\176\133\327\215\141\312\032\351\173\211\105\272\115\063\266"
	"\124\053\347\227\107\347\255\127\322\335\051\050\236\026\023\174"
	"\026\303\261\272\021\324\066\316\253\020\227\064\236\010\230\123"
	"\053\021\006\205\053\217\314\176\304\132\130\356\355\132\132\030"
	"\267\250\321\240\313\065\073\005\302\246\210\320\103\300\157\043"
	"\132\226\323\372\323\351\074\112\367\200\124\321\252\002\304\273"
	"\120\270\225\155\146\215\335\026\003\033\222\002\027\125\354\243"
	"\341\332\277\166\242\274\330\350\306\062\024\363\101\125\375\207"
	"\054\133\014\027\375\213\146\360\325\247\162\217\343\000\002\125"
	"\145\036\232\123\212\030\120\206\242\122\021\001\023\340\061\270"
	"\163\266\020\352\034\066\215\320\362\254\222\341\341\001\234\013"
	"\244\230\301\374\030\345\263\200\220\267\025\064\267\352\303\151"
	"\071\330\000\234\241\217\162\216\151\064\156\374\302\027\365\105"
	"\220\150\047\312\116\105\117\057\103\057\305\215\170\140\265\246"
	"\154\037\375\153\120\275\245\304\051\325\312\337\124\251\135\200"
	"\136\246\047\157\112\366\125\352\302\062\053\174\146\160\013\125"
	"\263\202\213\002\042\204\112\215\306\151\072\206\130\035\143\111"
	"\307\265\117\375\262\023\224\146\201\142\370\231\332\001\177\204"
	"\255\246\337\370\224\037\070\047\041\146\202\026\360\206\272\365"
	"\306\231\015\304\121\032\151\045\114\260\115\126\126\114\365\063"
	"\362\310\272\362\020\220\243\060\146\022\314\332\104\145\172\116"
	"\216\171\175\030\234\044\370\366\260\014\042\335\326\364\053\226"
	"\370\070\116\005\077\331\220\136\051\265\235\322\034\061\232\077"
	"\157\224\346\267\122\013\260\156\102\354\230\206\305\024\276\071"
	"\312\275\053\361\074\315\235\146\161\017\261\007\143\370\110\166"
	"\305\100\336\176\070\350\215\044\265\140\107\066\220\166\243\363"
	"\172\146\306\271\207\260\210\340\062\044\200\051\313\070\074\356"
	"\136\050\306\241\160\314\263\163\021\341\265\054\136\221\325\374"
	"\302\140\213\137\056\017\360\346\261\011\323\065\105\273\040\045"
	"\270\041\374\127\105\202\006\000\200\250\305\005\002\230\304\021"
	"\156\172\262\176\270\343\336\272\111\020\250\117\354\303\224\045"
	"\273\125\276\303\176\125\050\322\051\047\236\172\024\227\055\033"
	"\016\011\163\007\156\014\300\205\265\135\135\244\051\373\201\335"
	"\220\302\151\103\030\023\212\172\232\101\052\330\331\370\047\366"
	"\202\217\123\056\216\321\170\037\267\017\001\120\222\004\304\363"
	"\360\224\005\146\312\054\356\313\076\041\353\114\126\300\371\201"
	"\060\226\366\374\242\111\150\072\226\332\373\331\273\002\245\317"
	"\016\367\060\224\063\043\270\316\366\323\022\302\116\213\076\061"
	"\012\113\266\060\162\364\115\130\126\301\103\250\274\343\024\230"
	"\025\240\013\055\270\050\141\071\137\156\336\154\217\220\316\360"
	"\224\160\062\217\301\165\254\104\043\363\263\313\177\214\077\301"
	"\074\060\061\060\073\236\304\123\260\376\001\360\313\310\311\252"
	"\323\321\011\004\351\023\243\257\056\046\213\060\160\277\045\131"
	"\157\213\350\104\172\307\131\210\170\143\135\261\363\367\253\230"
	"\067\121\156\202\304\330\160\227\242\350\227\126\176\161\126\034"
	"\372\236\240\104\071\237\210\117\053\061\304\031\213\052\020\206"
	"\230\237\113\107\075\271\376\232\246\071\254\377\047\053\232\047"
	"\173\355\275\234\075\076\053\246\126\023\012\214\132\374\100\055"
	"\224\032\362\300\255\206\007\150\101\061\077\006\175\321\135\104"
	"\072\325\354\243\265\365\223\326\253\015\203\211\123\341\020\322"
	"\123\030\264\321\233\044\043\176\147\044\127\172\013\376\366\312"
	"\373\347\135\334\240\261\165\307\366\202\240\220\270\220\122\020"
	"\013\316\305\336\007\051\344\205\371\353\062\050\054\157\146\232"
	"\130\026\112\163\223\022\035\216\343\365\232\250\343\012\344\121"
	"\070\216\126\214\013\066\223\275\020\222\130\123\251\331\144\056"
	"\025\060\051\046\337\163\353\160\226\357\025\043\055\050\261\202"
	"\124\323\216\276\222\261\117\275\331\235\202\150\167\162\305\337"
	"\331\364\215\171\214\054\135\144\041\253\345\064\067\276\230\057"
	"\120\256\120\002\377\257\262\367\126\244\203\263\257\031\172\351"
	"\002\170\024\002\157\277\351\017\370\207\163\042\340\351\260\330"
	"\076\125\142\375\062\253\077\343\060\152\157\134\304\024\001\053"
	"\032\144\243\072\277\161\330\347\223\110\037\200\233\147\242\075"
	"\025\226\051\325\105\106\314\210\166\101\144\167\067\263\157\330"
	"\311\100\275\242\211\205\272\264\351\335\077\242\263\006\234\324"
	"\325\212\304\136\302\231\344\211\224\045\174\156\140\266\136\201"
	"\234\057\123\136\254\364\340\367\031\101\270\330\040\216\171\371"
	"\010\222\166\062\373\033\007\112\055\167\167\020\040\016\134\031"
	"\050\203\050\131\172\040\171\251\026\147\033\204\147\362\301\071"
	"\342\023\123\213\050\123\330\374\333\135\072\101\102\362\072\023"
	"\165\137\106\244\007\122\033\327\276\023\051\336\330\001\201\302"
	"\112\233\115\340\276\330\165\224\163\212\162\170\271\337\266\064"
	"\011\231\123\130\256\154\122\071\363\374\362\327\227\072\174\342"
	"\027\076\261\205\331\037\271\143\057\075\220\056\102\134\002\120"
	"\074\304\146\176\220\162\225\065\146\057\376\157\066\346\166\000"
	"\062\164\022\116\143\303\055\242\120\142\062\171\165\172\300\254"
	"\121\204\322\106\365\255\166\142\015\066\330\024\271\056\151\241"
	"\340\116\107\104\034\171\366\210\361\022\171\105\357\277\306\155"
	"\271\124\047\344\263\071\076\365\357\215\234\304\351\166\067\371"
	"\171\043\317\300\106\250\270\322\020\010\060\214\104\275\060\321"
	"\321\223\262\150\022\136\100\374\160\227\271\101\142\172\162\225"
	"\042\174\206\311\371\042\006\354\224\250\255\141\116\353\222\306"
	"\354\131\326\101\124\057\265\137\106\175\157\073\363\124\061\372"
	"\046\025\231\323\153\266\124\234\253\215\141\013\334\161\124\171"
	"\227\330\173\355\164\242\142\022\236\100\273\036\271\135\270\115"
	"\102\326\270\002\334\114\267\326\231\261\345\203\344\233\347\336"
	"\300\333\117\024\076\107\231\257\202\121\364\124\203\206\204\014"
	"\322\067\134\114\310\163\307\173\373\215\013\044\174\237\317\366"
	"\251\037\014\076\014\175\120\236\156\056\231\134\345\017\351\315"
	"\175\110\132\235\331\237\041\222\306\310\237\055\014\372\366\357"
	"\150\171\165\315\040\056\167\077\007\117\237\066\103\037\114\076"
	"\210\002\225\245\024\371\305\071\060\335\272\315\213\077\172\252"
	"\237\340\357\375\207\056\044\264\040\347\315\146\312\234\045\006"
	"\275\313\273\000\363\146\076\265\173\231\036\174\257\344\146\340"
	"\000\234\115\010\235\154\011\244\137\213\031\313\031\255\327\162"
	"\204\264\175\031\334\074\215\150\024\343\104\126\146\000\240\043"
	"\051\011\210\260\251\126\002\216\323\163\342\132\126\170\125\334"
	"\021\155\073\135\312\221\335\256\217\066\263\023\122\161\314\144"
	"\316\201\045\066\216\212\251\112\343\047\227\244\315\273\301\221"
	"\273\216\164\046\125\176\342\252\050\034\237\235\004\157\153\310"
	"\067\006\227\027\167\112\132\213\101\266\267\264\066\015\347\200"
	"\271\000\024\370\235\217\061\372\361\173\052\136\025\003\217\032"
	"\067\061\323\031\336\303\022\116\060\204\335\144\332\310\060\006"
	"\354\025\327\046\205\246\314\237\036\174\173\007\044\314\234\330"
	"\312\370\370\107\347\040\002\231\343\210\341\346\017\075\124\132"
	"\302\317\024\063\205\020\330\001\235\050\351\064\107\063\160\070"
	"\261\001\111\076\126\043\177\255\127\374\165\333\345\061\224\064"
	"\333\156\075\223\343\125\167\057\314\074\144\024\160\324\114\041"
	"\325\225\137\054\271\336\332\021\333\117\354\301\201\201\365\134"
	"\357\062\357\322\210\147\002\124\244\147\151\024\073\265\065\021"
	"\113\225\076\005\163\030\026\117\150\003\020\351\204\005\106\164"
	"\070\066\107\300\235\111\025\102\260\176\126\354\064\214\376\177"
	"\041\075\204\225\126\233\344\277\236\365\250\043\373\357\227\064"
	"\045\336\365\302\050\012\005\331\211\133\306\275\350\304\075\012"
	"\002\302\237\130\135\204\027\374\171\300\037\165\257\267\251\324"
	"\226\236\227\276\251\235\230\062\371\136\360\341\043\056\353\045"
	"\360\213\176\116\017\226\112\211\126\152\377\006\041\250\333\267"
	"\107\163\165\360\020\015\043\011\154\023\353\217\102\327\264\062"
	"\142\062\200\162\310\313\374\037\065\373\045\126\244\001\016\353"
	"\164\204\334\204\222\377\216\376\023\171\215\125\120\101\207\263"
	"\164\010\045\075\324\042\135\011\035\202\140\302\203\156\256\370"
	"\362\212\175\204\211\013\202\234\205\017\361\325\121\171\211\306"
	"\202\256\004\126\321\141\140\357\344\300\261\150\057\137\140\041"
	"\351\335\245\163\351\050\017\156\070\001\103\212\173\314\120\376"
	"\173\125\125\114\266\265\073\232\166\355\002\245\115\143\306\066"
	"\101\154\251\052\224\271\230\315\273\333\127\067\250\250\065\044"
	"\375\212\161\264\077\255\116\266\232\121\133\347\265\042\036\366"
	"\216\310\040\043\201\270\360\075\224\110\164\074\360\251\141\356"
	"\064\322\242\164\177\361\052\032\103\205\001\370\247\040\357\066"
	"\350\017\131\152\310\112\247\134\222\034\231\203\306\372\161\372"
	"\314\024\156\114\005\230\146\110\036\150\101\306\210\060\374\160"
	"\100\126\333\010"
#define      inlo_z	3
#define      inlo	((&data[5181]))
	"\037\163\344"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
